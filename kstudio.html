<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>k-studio | Official</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root { --rbx-green: #02b159; --rbx-blue: #00A2FF; --rbx-red: #FF2525; --bg: #F2F4F5; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* AUTH OVERLAY */
        #auth-overlay { position: fixed; inset: 0; background: white; z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .auth-card { width: 350px; padding: 30px; border: 1px solid #ddd; border-radius: 12px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }

        /* GAME UI */
        #main-ui { display: none; height: 100%; }
        #nav-bar { width: 240px; height: 100%; background: #FFF; border-right: 1px solid #D5D5D5; position: fixed; display: flex; flex-direction: column; }
        #content { margin-left: 240px; height: 100%; background: var(--bg); padding: 40px; box-sizing: border-box; }
        
        /* EDITOR */
        #editor-window { position: fixed; inset: 0; background: white; z-index: 5000; display: none; flex-direction: column; }
        #viewport { flex: 1; background: #000; }
        .ribbon { background: #F5F6F7; border-bottom: 1px solid #CCC; padding: 10px; display: flex; gap: 10px; }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <div class="auth-card">
            <h1 style="color:var(--rbx-red)">k-studio</h1>
            <p style="font-size: 14px; color: #666;">Sign in to publish games.</p>
            <div id="g_id_onload"
                 data-client_id="712854302422-v8n10vsc4j2v1p87oqc3j8p5a3o2p2p2.apps.googleusercontent.com"
                 data-callback="handleAuth"
                 data-ux_mode="popup">
            </div>
            <div class="g_id_signin" data-type="standard"></div>
            <button onclick="enter()" style="margin-top:15px; width:100%; padding:10px; cursor:pointer; background:#eee; border:none; border-radius:5px;">Continue as Guest</button>
        </div>
    </div>

    <div id="main-ui">
        <div id="nav-bar">
            <div style="padding:25px; font-weight:900; font-size:24px;">k-studio</div>
            <div style="padding:15px 25px; cursor:pointer;" onclick="openStudio()">+ CREATE GAME</div>
        </div>
        <div id="content">
            <h1>Discovery</h1>
            <p>Welcome, <span id="user-name">Guest</span>!</p>
        </div>
    </div>

    <div id="editor-window">
        <div class="ribbon">
            <button onclick="addBox()">Add Part</button>
            <button onclick="closeStudio()" style="background:var(--rbx-red); color:white; border:none;">EXIT</button>
        </div>
        <div id="viewport"></div>
    </div>

    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

        // AUTH LOGIC
        window.handleAuth = (resp) => {
            const user = JSON.parse(atob(resp.credential.split('.')[1]));
            document.getElementById('user-name').innerText = user.name;
            enter();
        };

        window.enter = () => {
            document.getElementById('auth-overlay').style.display = 'none';
            document.getElementById('main-ui').style.display = 'block';
        };

        // STUDIO LOGIC
        let scene, camera, renderer;
        window.openStudio = () => {
            document.getElementById('editor-window').style.display = 'flex';
            if (!scene) init3D();
        };

        window.closeStudio = () => {
            document.getElementById('editor-window').style.display = 'none';
        };

        function init3D() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xAACCFF);
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(10, 10, 10); camera.lookAt(0,0,0);
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('viewport').appendChild(renderer.domElement);
            scene.add(new THREE.GridHelper(100, 100), new THREE.AmbientLight(0xffffff, 1));
            function anim() { requestAnimationFrame(anim); renderer.render(scene, camera); }
            anim();
        }

        window.addBox = () => {
            const box = new THREE.Mesh(new THREE.BoxGeometry(2,2,2), new THREE.MeshStandardMaterial({color: 0xcccccc}));
            scene.add(box);
        };
    </script>
</body>
</html>
